-- Insertion catalogue EUROCIEL (produits + barcodes placeholders + price history)
BEGIN;
INSERT INTO processed_invoices (tenant_id, invoice_id, supplier, facture_date, line_count, file_path)
VALUES (1, 'EUROCIEL-280', 'EUROCIEL', '2025-12-03', 110, 'synthetic/EUROCIEL_catalogue.csv')
ON CONFLICT (tenant_id, invoice_id) DO NOTHING;

WITH new_prod(nom, categorie, prix_vente, tva, tenant_id) AS (
  VALUES
('140 SACHET À PESER (10KG)', 'Emballages / Jetables', 0, 5.5, 1),
('150 CARTON EN VRAC ENVIRON 4KG', 'Emballages / Jetables', 0, 5.5, 1),
('SACHET A PESER (10KG)', 'Emballages / Jetables', 0, 5.5, 1),
('MAHI MAHI 10 X 800G', 'Épicerie sucrée', 0, 5.5, 1),
('CHINE 12X1KG', 'Épicerie sucrée', 0, 5.5, 1),
('NON CUIT 10X20PCS', 'Épicerie sucrée', 0, 5.5, 1),
('REF.18', 'Épicerie sucrée', 0, 5.5, 1),
('REF.1 1', 'Épicerie sucrée', 0, 5.5, 1),
('REF.19', 'Épicerie sucrée', 0, 5.5, 1),
('FRITES (9X9)', 'Épicerie sucrée', 0, 5.5, 1),
('BARRACUDA ENTIER 1000/2000 - 10 KG', 'Épicerie sucrée', 0, 5.5, 1),
('BARRACUDA ENTIER 2000/3000 - 10KG', 'Épicerie sucrée', 0, 5.5, 1),
('BARRACUDA ENTIER 3000/5000 - 20KG', 'Épicerie sucrée', 0, 5.5, 1),
('BARRACUDA ENTIER 5000/10000 - 20KG', 'Épicerie sucrée', 0, 5.5, 1),
('CAPITAINE / EMPEROR G&V 1/2 KG', 'Boulangerie / Viennoiserie', 0, 5.5, 1),
('CAPITAINE / EMPEROR G&V 2/3 KG', 'Boulangerie / Viennoiserie', 0, 5.5, 1),
('CAPITAINE / EMPEROR G&V 5/10 KG', 'Boulangerie / Viennoiserie', 0, 5.5, 1),
('CHINCHARD 300/500 CHILI 10KG', 'Mer / Viandes base', 0, 5.5, 1),
('CHINCHARD 900+ CHILI 20KG', 'Mer / Viandes base', 0, 5.5, 1),
('CHINCHARD ENTIER FUME 5KG', 'Mer / Viandes base', 0, 5.5, 1),
('CHINCHARD N-Z 600/900 (2X10KG) 20KG', 'Mer / Viandes base', 0, 5.5, 1),
('CHINCHARD VRAC CARTON 4KG', 'Mer / Viandes base', 0, 5.5, 1),
('COLAFIL 2/3 KGS (23 KG)', 'Softs / Énergisants', 0, 5.5, 1),
('COLAFIL 3/5 KGS (23 KG)', 'Softs / Énergisants', 0, 5.5, 1),
('MACHOIRON 15KG', 'Épicerie sucrée', 0, 5.5, 1),
('MAQUEREAU 2/4 PCS 10 X 1KG', 'Eaux', 0, 5.5, 1),
('MAQUEREAU 800/1000 VRAC IQF 10KG', 'Eaux', 0, 5.5, 1),
('MEROU ENTIER 10 KG + (24KG) INDONES', 'Épicerie sucrée', 0, 5.5, 1),
('MEROU ENTIER 2-3 KG (18KG) YEMEN', 'Épicerie sucrée', 0, 5.5, 1),
('MEROU ENTIER 3-5KG (23KG) YEMEN', 'Épicerie sucrée', 0, 5.5, 1),
('MEROU ENTIER 5-10 KG (23KG) YEMEN', 'Épicerie sucrée', 0, 5.5, 1),
('OMBRINE G&V ARGENTINE 1000/1500G 5K PANGASIUS ENTIER 500/800 4KG', 'Vins rouges', 0, 5.5, 1),
('PERROQUET 300/500 5X2KG', 'Épicerie sucrée', 0, 5.5, 1),
('POISSON CHAT 500/800 4 KG', 'Mer / Viandes base', 0, 5.5, 1),
('SOLE 300/400 - 10KG VRAC', 'Épicerie sucrée', 0, 5.5, 1),
('SOMPATTE G&V 400/600 SACHET', 'Emballages / Jetables', 0, 5.5, 1),
('THIEKEM G&V 400+', 'Épicerie sucrée', 0, 5.5, 1),
('TILAPIA 1000+ 4KG', 'Mer / Viandes base', 0, 5.5, 1),
('TILAPIA 400/600 ''THAILANDE''', 'Mer / Viandes base', 0, 5.5, 1),
('TILAPIA 800+ ''CHINE''', 'Mer / Viandes base', 0, 5.5, 1),
('TILAPIA ROUGE 500/700 4KG', 'Mer / Viandes base', 0, 5.5, 1),
('DARNE DE ''BABY'' REQUIN 10X800GR', 'Épicerie sucrée', 0, 5.5, 1),
('DARNE DE BARRACUDA 10 X 800G', 'Épicerie sucrée', 0, 5.5, 1),
('DARNE DE MEROU 4KG VRAC 3/6', 'Épicerie sucrée', 0, 5.5, 1),
('DARNE DE PANGASUIS 4KG (4X800GR)', 'Épicerie sucrée', 0, 5.5, 1),
('DARNE DE REQUIN 10X800G', 'Épicerie sucrée', 0, 5.5, 1),
('DARNE DE THAZARD 10X800GR', 'Épicerie sucrée', 0, 5.5, 1),
('DARNE DE THON 15X800GR (640GNET)', 'Conserves / Tomates', 0, 5.5, 1),
('DARNE DE TILAPIA 15 X 800G', 'Mer / Viandes base', 0, 5.5, 1),
('DARNE DE VIVANEAU 10X800G', 'Eaux', 0, 5.5, 1),
('AILES DE POULET FUMEE 8 X 1KG', 'Mer / Viandes base', 0, 5.5, 1),
('COTE DE PORC FUMEE 13KG', 'Épicerie sucrée', 0, 5.5, 1),
('COTIS DE PORC FUME ''A'' 10 X 1KG', 'Épicerie sucrée', 0, 5.5, 1),
('COU DE DINDE FUME 8X1KG', 'Mer / Viandes base', 0, 5.5, 1),
('CUISSE DE POULET FUMEE 8 X 1KG', 'Mer / Viandes base', 0, 5.5, 1),
('MIXTE DE PORC 10X1KG', 'Épicerie sucrée', 0, 5.5, 1),
('MORUE DESSALEE 12 X 800GRS', 'Mer / Viandes base', 0, 5.5, 1),
('POISSON CHAT FUMEE 5KG', 'Mer / Viandes base', 0, 5.5, 1),
('AILES DE POULET GRADE A 10KG', 'Mer / Viandes base', 0, 5.5, 1),
('AILES DE POULET SACHET 5 X 2KG', 'Mer / Viandes base', 0, 5.5, 1),
('CUBE DE BOEUF 2 X2.5KG', 'Mer / Viandes base', 0, 5.5, 1),
('CUISSE DE POULET GRADE A 10KG', 'Mer / Viandes base', 0, 5.5, 1),
('CUISSE DE POULET SACHET 5 X 2KG', 'Mer / Viandes base', 0, 5.5, 1),
('PILON DE POULET 5 X 2KG', 'Mer / Viandes base', 0, 5.5, 1),
('PILON DE POULET 5KG', 'Mer / Viandes base', 0, 5.5, 1),
('POULE AFRICA 10 X 1.3KG', 'Épicerie sucrée', 0, 5.5, 1),
('POULE DOUX 1.2KG 12PCS', 'Épicerie sucrée', 0, 5.5, 1),
('POULE DOUX 2.2KG 7PCS', 'Épicerie sucrée', 0, 5.5, 1),
('POULE PLUVERA 10 X 1000 G', 'Épicerie sucrée', 0, 5.5, 1),
('POULE PLUVERA 10 X 1100 G', 'Épicerie sucrée', 0, 5.5, 1),
('POULE PLUVERA 10 X 1200 G', 'Épicerie sucrée', 0, 5.5, 1),
('POULE PLUVERA 10 X 1300 G', 'Épicerie sucrée', 0, 5.5, 1),
('CREVETTE GAMBAS 13/15 6X 800G', 'Mer / Viandes base', 0, 5.5, 1),
('CREVETTE GAMBAS 31/40 12X400G', 'Mer / Viandes base', 0, 5.5, 1),
('CREVETTE ROSE DECORTIQUE (12X800GR)', 'Vins rosés', 0, 5.5, 1),
('CREVETTE ROSE DECORTIQUE (25X400G) CREVETTE S/TETE 31/40 BT 20X500GR', 'Vins rosés', 0, 5.5, 1),
('LAMBI 10 X 450GR', 'Épicerie sucrée', 0, 5.5, 1),
('NOIX DE ST JACQUES 60/80 (25X400G)', 'Épicerie sucrée', 0, 5.5, 1),
('AIL 40 X 250G', 'Épices / Herbes / Bouillons', 0, 5.5, 1),
('AMARANTE (BITEKU) 20 X 500G', 'Épicerie sucrée', 0, 5.5, 1),
('18 132 GINGEMBRE HACHE 20X500G', 'Spiritueux', 0, 5.5, 1),
('10 260 GOMBO COUPÉ 20X500G', 'Épicerie sucrée', 0, 5.5, 1),
('18 147 HARICOT BLANC 20 X 500GR', 'Vins blancs', 0, 5.5, 1),
('18 121 HARICOT VERT 20 X 400GR', 'Épicerie sucrée', 0, 5.5, 1),
('18 139 PIMENT VEGETARIEN 25 X 200G', 'Épices / Herbes / Bouillons', 0, 5.5, 1),
('15 101 PLACALI 25 X 400 G', 'Épicerie sucrée', 0, 5.5, 1),
('18 100 POIS D''ANGOLE', 'Épicerie sucrée', 0, 5.5, 1),
('18 110 POIS DU VAL', 'Épicerie sucrée', 0, 5.5, 1),
('18 120 SAKA SAKA 20X500G', 'Épicerie sucrée', 0, 5.5, 1),
('18 130 TARO 10X500G', 'Épicerie sucrée', 0, 5.5, 1),
('CORDON BLEU ''HALAL'' 5X1KG', 'Épicerie sucrée', 0, 5.5, 1),
('FEUILLE DE SPRING ROLL 20X40P', 'Épicerie sucrée', 0, 5.5, 1),
('FRITE DE POULET 2 X 2.5KG', 'Mer / Viandes base', 0, 5.5, 1),
('KEBAB DE POULET 4X1KG', 'Mer / Viandes base', 0, 5.5, 1),
('NUGGETS DE POULET 5X1 KG', 'Mer / Viandes base', 0, 5.5, 1),
('PAROTTA AL SHAMAS 24X5', 'Épicerie sucrée', 0, 5.5, 1),
('PAROTTA FAMILY 6 X 20PCS', 'Épicerie sucrée', 0, 5.5, 1),
('PAROTTA REGULAR LOVELY 48 PCS', 'Épicerie sucrée', 0, 5.5, 1),
('PAROTTA VA/IBECO 12 X 1600', 'Épicerie sucrée', 0, 5.5, 1),
('POULET TANDOORI 12X1KG', 'Mer / Viandes base', 0, 5.5, 1),
('SAMOSA AGNEAU 15X20', 'Eaux', 0, 5.5, 1),
('SAMOSA AGNEAU 6X50', 'Eaux', 0, 5.5, 1),
('SAMOSA LEGUME 15X20', 'Fruits / Légumes frais', 0, 5.5, 1),
('SAMOSA LEGUME 6X50', 'Fruits / Légumes frais', 0, 5.5, 1),
('SAMOSA POULET 15X20', 'Mer / Viandes base', 0, 5.5, 1),
('SAMOSA POULET 6X50', 'Mer / Viandes base', 0, 5.5, 1),
('SAUSSISE DE POULET 28 X 10PCS', 'Mer / Viandes base', 0, 5.5, 1),
('STEAK HACHE BOEUF 4KG VRAC', 'Mer / Viandes base', 0, 5.5, 1),
('TEX MEX AILES DE POULET 2.5KG', 'Mer / Viandes base', 0, 5.5, 1),
('18 001 RIZ LONG PARFUME CAMBODGE 20 KG', 'Pâtes / Riz / Semoule / Farine', 0, 5.5, 1)
),
ins_prod AS (
  INSERT INTO produits (nom, categorie, prix_vente, tva, tenant_id)
  SELECT nom, categorie, prix_vente, tva, tenant_id FROM new_prod
  ON CONFLICT DO NOTHING
  RETURNING id, nom, categorie, tenant_id
),
all_prod AS (
  SELECT id, nom, categorie, tenant_id FROM ins_prod
  UNION ALL
  SELECT p.id, p.nom, p.categorie, p.tenant_id
  FROM produits p
  JOIN new_prod np ON p.tenant_id=np.tenant_id AND lower(p.nom)=lower(np.nom)
),
new_bc(code, symbologie, pays_iso2, is_principal, tenant_id, target_nom) AS (
  VALUES
('ECZ0001', 'PLHDR', NULL, TRUE, 1, '140 SACHET À PESER (10KG)'),
('ECZ0002', 'PLHDR', NULL, TRUE, 1, '150 CARTON EN VRAC ENVIRON 4KG'),
('ECZ0003', 'PLHDR', NULL, TRUE, 1, 'SACHET A PESER (10KG)'),
('ECZ0004', 'PLHDR', NULL, TRUE, 1, 'MAHI MAHI 10 X 800G'),
('ECZ0005', 'PLHDR', NULL, TRUE, 1, 'CHINE 12X1KG'),
('ECZ0006', 'PLHDR', NULL, TRUE, 1, 'NON CUIT 10X20PCS'),
('ECZ0007', 'PLHDR', NULL, TRUE, 1, 'REF.18'),
('ECZ0008', 'PLHDR', NULL, TRUE, 1, 'REF.1 1'),
('ECZ0009', 'PLHDR', NULL, TRUE, 1, 'REF.19'),
('ECZ0010', 'PLHDR', NULL, TRUE, 1, 'FRITES (9X9)'),
('ECZ0011', 'PLHDR', NULL, TRUE, 1, 'BARRACUDA ENTIER 1000/2000 - 10 KG'),
('ECZ0012', 'PLHDR', NULL, TRUE, 1, 'BARRACUDA ENTIER 2000/3000 - 10KG'),
('ECZ0013', 'PLHDR', NULL, TRUE, 1, 'BARRACUDA ENTIER 3000/5000 - 20KG'),
('ECZ0014', 'PLHDR', NULL, TRUE, 1, 'BARRACUDA ENTIER 5000/10000 - 20KG'),
('ECZ0015', 'PLHDR', NULL, TRUE, 1, 'CAPITAINE / EMPEROR G&V 1/2 KG'),
('ECZ0016', 'PLHDR', NULL, TRUE, 1, 'CAPITAINE / EMPEROR G&V 2/3 KG'),
('ECZ0017', 'PLHDR', NULL, TRUE, 1, 'CAPITAINE / EMPEROR G&V 5/10 KG'),
('ECZ0018', 'PLHDR', NULL, TRUE, 1, 'CHINCHARD 300/500 CHILI 10KG'),
('ECZ0019', 'PLHDR', NULL, TRUE, 1, 'CHINCHARD 900+ CHILI 20KG'),
('ECZ0020', 'PLHDR', NULL, TRUE, 1, 'CHINCHARD ENTIER FUME 5KG'),
('ECZ0021', 'PLHDR', NULL, TRUE, 1, 'CHINCHARD N-Z 600/900 (2X10KG) 20KG'),
('ECZ0022', 'PLHDR', NULL, TRUE, 1, 'CHINCHARD VRAC CARTON 4KG'),
('ECZ0023', 'PLHDR', NULL, TRUE, 1, 'COLAFIL 2/3 KGS (23 KG)'),
('ECZ0024', 'PLHDR', NULL, TRUE, 1, 'COLAFIL 3/5 KGS (23 KG)'),
('ECZ0025', 'PLHDR', NULL, TRUE, 1, 'MACHOIRON 15KG'),
('ECZ0026', 'PLHDR', NULL, TRUE, 1, 'MAQUEREAU 2/4 PCS 10 X 1KG'),
('ECZ0027', 'PLHDR', NULL, TRUE, 1, 'MAQUEREAU 800/1000 VRAC IQF 10KG'),
('ECZ0028', 'PLHDR', NULL, TRUE, 1, 'MEROU ENTIER 10 KG + (24KG) INDONES'),
('ECZ0029', 'PLHDR', NULL, TRUE, 1, 'MEROU ENTIER 2-3 KG (18KG) YEMEN'),
('ECZ0030', 'PLHDR', NULL, TRUE, 1, 'MEROU ENTIER 3-5KG (23KG) YEMEN'),
('ECZ0031', 'PLHDR', NULL, TRUE, 1, 'MEROU ENTIER 5-10 KG (23KG) YEMEN'),
('ECZ0032', 'PLHDR', NULL, TRUE, 1, 'OMBRINE G&V ARGENTINE 1000/1500G 5K PANGASIUS ENTIER 500/800 4KG'),
('ECZ0033', 'PLHDR', NULL, TRUE, 1, 'PERROQUET 300/500 5X2KG'),
('ECZ0034', 'PLHDR', NULL, TRUE, 1, 'POISSON CHAT 500/800 4 KG'),
('ECZ0035', 'PLHDR', NULL, TRUE, 1, 'SOLE 300/400 - 10KG VRAC'),
('ECZ0036', 'PLHDR', NULL, TRUE, 1, 'SOMPATTE G&V 400/600 SACHET'),
('ECZ0037', 'PLHDR', NULL, TRUE, 1, 'THIEKEM G&V 400+'),
('ECZ0038', 'PLHDR', NULL, TRUE, 1, 'TILAPIA 1000+ 4KG'),
('ECZ0039', 'PLHDR', NULL, TRUE, 1, 'TILAPIA 400/600 ''THAILANDE'''),
('ECZ0040', 'PLHDR', NULL, TRUE, 1, 'TILAPIA 800+ ''CHINE'''),
('ECZ0041', 'PLHDR', NULL, TRUE, 1, 'TILAPIA ROUGE 500/700 4KG'),
('ECZ0042', 'PLHDR', NULL, TRUE, 1, 'DARNE DE ''BABY'' REQUIN 10X800GR'),
('ECZ0043', 'PLHDR', NULL, TRUE, 1, 'DARNE DE BARRACUDA 10 X 800G'),
('ECZ0044', 'PLHDR', NULL, TRUE, 1, 'DARNE DE MEROU 4KG VRAC 3/6'),
('ECZ0045', 'PLHDR', NULL, TRUE, 1, 'DARNE DE PANGASUIS 4KG (4X800GR)'),
('ECZ0046', 'PLHDR', NULL, TRUE, 1, 'DARNE DE REQUIN 10X800G'),
('ECZ0047', 'PLHDR', NULL, TRUE, 1, 'DARNE DE THAZARD 10X800GR'),
('ECZ0048', 'PLHDR', NULL, TRUE, 1, 'DARNE DE THON 15X800GR (640GNET)'),
('ECZ0049', 'PLHDR', NULL, TRUE, 1, 'DARNE DE TILAPIA 15 X 800G'),
('ECZ0050', 'PLHDR', NULL, TRUE, 1, 'DARNE DE VIVANEAU 10X800G'),
('ECZ0051', 'PLHDR', NULL, TRUE, 1, 'AILES DE POULET FUMEE 8 X 1KG'),
('ECZ0052', 'PLHDR', NULL, TRUE, 1, 'COTE DE PORC FUMEE 13KG'),
('ECZ0053', 'PLHDR', NULL, TRUE, 1, 'COTIS DE PORC FUME ''A'' 10 X 1KG'),
('ECZ0054', 'PLHDR', NULL, TRUE, 1, 'COU DE DINDE FUME 8X1KG'),
('ECZ0055', 'PLHDR', NULL, TRUE, 1, 'CUISSE DE POULET FUMEE 8 X 1KG'),
('ECZ0056', 'PLHDR', NULL, TRUE, 1, 'MIXTE DE PORC 10X1KG'),
('ECZ0057', 'PLHDR', NULL, TRUE, 1, 'MORUE DESSALEE 12 X 800GRS'),
('ECZ0058', 'PLHDR', NULL, TRUE, 1, 'POISSON CHAT FUMEE 5KG'),
('ECZ0059', 'PLHDR', NULL, TRUE, 1, 'AILES DE POULET GRADE A 10KG'),
('ECZ0060', 'PLHDR', NULL, TRUE, 1, 'AILES DE POULET SACHET 5 X 2KG'),
('ECZ0061', 'PLHDR', NULL, TRUE, 1, 'CUBE DE BOEUF 2 X2.5KG'),
('ECZ0062', 'PLHDR', NULL, TRUE, 1, 'CUISSE DE POULET GRADE A 10KG'),
('ECZ0063', 'PLHDR', NULL, TRUE, 1, 'CUISSE DE POULET SACHET 5 X 2KG'),
('ECZ0064', 'PLHDR', NULL, TRUE, 1, 'PILON DE POULET 5 X 2KG'),
('ECZ0065', 'PLHDR', NULL, TRUE, 1, 'PILON DE POULET 5KG'),
('ECZ0066', 'PLHDR', NULL, TRUE, 1, 'POULE AFRICA 10 X 1.3KG'),
('ECZ0067', 'PLHDR', NULL, TRUE, 1, 'POULE DOUX 1.2KG 12PCS'),
('ECZ0068', 'PLHDR', NULL, TRUE, 1, 'POULE DOUX 2.2KG 7PCS'),
('ECZ0069', 'PLHDR', NULL, TRUE, 1, 'POULE PLUVERA 10 X 1000 G'),
('ECZ0070', 'PLHDR', NULL, TRUE, 1, 'POULE PLUVERA 10 X 1100 G'),
('ECZ0071', 'PLHDR', NULL, TRUE, 1, 'POULE PLUVERA 10 X 1200 G'),
('ECZ0072', 'PLHDR', NULL, TRUE, 1, 'POULE PLUVERA 10 X 1300 G'),
('ECZ0073', 'PLHDR', NULL, TRUE, 1, 'CREVETTE GAMBAS 13/15 6X 800G'),
('ECZ0074', 'PLHDR', NULL, TRUE, 1, 'CREVETTE GAMBAS 31/40 12X400G'),
('ECZ0075', 'PLHDR', NULL, TRUE, 1, 'CREVETTE ROSE DECORTIQUE (12X800GR)'),
('ECZ0076', 'PLHDR', NULL, TRUE, 1, 'CREVETTE ROSE DECORTIQUE (25X400G) CREVETTE S/TETE 31/40 BT 20X500GR'),
('ECZ0077', 'PLHDR', NULL, TRUE, 1, 'LAMBI 10 X 450GR'),
('ECZ0078', 'PLHDR', NULL, TRUE, 1, 'NOIX DE ST JACQUES 60/80 (25X400G)'),
('ECZ0079', 'PLHDR', NULL, TRUE, 1, 'AIL 40 X 250G'),
('ECZ0080', 'PLHDR', NULL, TRUE, 1, 'AMARANTE (BITEKU) 20 X 500G'),
('ECZ0081', 'PLHDR', NULL, TRUE, 1, '18 132 GINGEMBRE HACHE 20X500G'),
('ECZ0082', 'PLHDR', NULL, TRUE, 1, '10 260 GOMBO COUPÉ 20X500G'),
('ECZ0083', 'PLHDR', NULL, TRUE, 1, '18 147 HARICOT BLANC 20 X 500GR'),
('ECZ0084', 'PLHDR', NULL, TRUE, 1, '18 121 HARICOT VERT 20 X 400GR'),
('ECZ0085', 'PLHDR', NULL, TRUE, 1, '18 139 PIMENT VEGETARIEN 25 X 200G'),
('ECZ0086', 'PLHDR', NULL, TRUE, 1, '15 101 PLACALI 25 X 400 G'),
('ECZ0087', 'PLHDR', NULL, TRUE, 1, '18 100 POIS D''ANGOLE'),
('ECZ0088', 'PLHDR', NULL, TRUE, 1, '18 110 POIS DU VAL'),
('ECZ0089', 'PLHDR', NULL, TRUE, 1, '18 120 SAKA SAKA 20X500G'),
('ECZ0090', 'PLHDR', NULL, TRUE, 1, '18 130 TARO 10X500G'),
('ECZ0091', 'PLHDR', NULL, TRUE, 1, 'CORDON BLEU ''HALAL'' 5X1KG'),
('ECZ0092', 'PLHDR', NULL, TRUE, 1, 'FEUILLE DE SPRING ROLL 20X40P'),
('ECZ0093', 'PLHDR', NULL, TRUE, 1, 'FRITE DE POULET 2 X 2.5KG'),
('ECZ0094', 'PLHDR', NULL, TRUE, 1, 'KEBAB DE POULET 4X1KG'),
('ECZ0095', 'PLHDR', NULL, TRUE, 1, 'NUGGETS DE POULET 5X1 KG'),
('ECZ0096', 'PLHDR', NULL, TRUE, 1, 'PAROTTA AL SHAMAS 24X5'),
('ECZ0097', 'PLHDR', NULL, TRUE, 1, 'PAROTTA FAMILY 6 X 20PCS'),
('ECZ0098', 'PLHDR', NULL, TRUE, 1, 'PAROTTA REGULAR LOVELY 48 PCS'),
('ECZ0099', 'PLHDR', NULL, TRUE, 1, 'PAROTTA VA/IBECO 12 X 1600'),
('ECZ0100', 'PLHDR', NULL, TRUE, 1, 'POULET TANDOORI 12X1KG'),
('ECZ0101', 'PLHDR', NULL, TRUE, 1, 'SAMOSA AGNEAU 15X20'),
('ECZ0102', 'PLHDR', NULL, TRUE, 1, 'SAMOSA AGNEAU 6X50'),
('ECZ0103', 'PLHDR', NULL, TRUE, 1, 'SAMOSA LEGUME 15X20'),
('ECZ0104', 'PLHDR', NULL, TRUE, 1, 'SAMOSA LEGUME 6X50'),
('ECZ0105', 'PLHDR', NULL, TRUE, 1, 'SAMOSA POULET 15X20'),
('ECZ0106', 'PLHDR', NULL, TRUE, 1, 'SAMOSA POULET 6X50'),
('ECZ0107', 'PLHDR', NULL, TRUE, 1, 'SAUSSISE DE POULET 28 X 10PCS'),
('ECZ0108', 'PLHDR', NULL, TRUE, 1, 'STEAK HACHE BOEUF 4KG VRAC'),
('ECZ0109', 'PLHDR', NULL, TRUE, 1, 'TEX MEX AILES DE POULET 2.5KG'),
('ECZ0110', 'PLHDR', NULL, TRUE, 1, '18 001 RIZ LONG PARFUME CAMBODGE 20 KG')
)
INSERT INTO produits_barcodes (produit_id, code, symbologie, pays_iso2, is_principal, tenant_id)
SELECT p.id, nb.code, nb.symbologie, nb.pays_iso2, nb.is_principal, nb.tenant_id
FROM new_bc nb
JOIN all_prod p ON p.tenant_id=nb.tenant_id AND lower(p.nom)=lower(nb.target_nom)
WHERE NOT EXISTS (
  SELECT 1 FROM produits_barcodes pb WHERE pb.tenant_id=nb.tenant_id AND lower(pb.code)=lower(nb.code)
);

WITH new_ph(code, fournisseur, prix_achat, quantite, facture_date, source_context, tenant_id) AS (
  VALUES
('ECZ0001', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0002', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0003', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0004', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0005', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0006', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0007', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0008', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0009', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0010', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0011', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0012', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0013', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0014', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0015', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0016', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0017', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0018', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0019', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0020', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0021', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0022', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0023', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0024', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0025', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0026', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0027', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0028', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0029', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0030', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0031', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0032', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0033', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0034', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0035', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0036', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0037', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0038', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0039', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0040', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0041', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0042', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0043', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0044', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0045', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0046', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0047', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0048', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0049', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0050', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0051', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0052', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0053', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0054', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0055', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0056', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0057', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0058', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0059', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0060', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0061', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0062', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0063', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0064', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0065', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0066', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0067', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0068', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0069', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0070', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0071', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0072', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0073', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0074', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0075', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0076', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0077', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0078', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0079', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0080', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0081', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0082', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0083', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0084', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0085', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0086', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0087', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0088', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0089', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0090', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0091', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0092', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0093', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0094', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0095', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0096', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0097', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0098', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0099', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0100', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0101', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0102', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0103', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0104', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0105', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0106', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0107', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0108', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0109', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1),
('ECZ0110', 'EUROCIEL', 0, 0, '2025-12-03'::timestamptz, 'EUROCIEL catalogue', 1)
)
INSERT INTO produits_price_history (code, fournisseur, prix_achat, quantite, facture_date, source_context, tenant_id)
SELECT * FROM new_ph;
COMMIT;
